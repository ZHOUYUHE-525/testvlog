<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ê±âËØ≠ Vlog | </title>
    
    <!-- Á´ôÁÇπÂõæÊ†á -->
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="auth.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --primary: #6CAD9C;    /* ÁÅ∞Áªø */
            --accent: #E5CC84;     /* ÊüîÈáë */
            --dark-red: #612321;   /* Ê∑±Á∫¢ */
            --terracotta: #A77046; /* Ê£ïÁ∫¢ */
            --beige: #E5DABC;      /* Á±≥ÈªÑ */
            --glass: rgba(0, 0, 0, 0.7);
        }

        body, html { margin: 0; padding: 0; min-height: 100%; font-family: "PingFang SC", "Microsoft YaHei", sans-serif; background: #000; color: white; scroll-behavior: smooth; }

        /* ËÉåÊôØËÆæÁΩÆ */
        .bg-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0.9) 100%), 
                        url('https://images.unsplash.com/photo-1518481612222-68bbe828ecd1?q=80&w=2070&auto=format&fit=crop');
            background-size: cover; background-position: center; z-index: -1;
        }

        .top-nav { position: fixed; top: 20px; right: 20px; z-index: 1000; }
        .lang-btn { background: var(--glass); border: 1px solid var(--terracotta); color: white; padding: 8px 18px; border-radius: 20px; cursor: pointer; backdrop-filter: blur(10px); font-size: 13px; font-weight: bold; }

        .wrapper { display: flex; flex-direction: column; align-items: center; padding: 80px 20px; }

        /* ÁôªÂΩïÂç°Áâá */
        .login-card {
            background: var(--glass); backdrop-filter: blur(40px); -webkit-backdrop-filter: blur(40px);
            border: 1px solid rgba(167, 112, 70, 0.3); border-radius: 24px; padding: 40px; width: 100%; max-width: 380px;
            text-align: center; box-shadow: 0 30px 60px rgba(0,0,0,0.8); margin-bottom: 60px;
        }

        .logo-area i { font-size: 45px; color: var(--terracotta); margin-bottom: 15px; }
        .logo-area h1 { font-size: 28px; margin: 0; letter-spacing: 3px; color: var(--beige); }

        .input-group { margin-top: 25px; text-align: left; }
        .input-group label { display: block; font-size: 11px; color: var(--beige); opacity: 0.8; margin-bottom: 5px; padding-left: 5px;}
        input {
            width: 100%; padding: 14px; border-radius: 10px;
            background: rgba(255,255,255,0.05); border: 1px solid rgba(167, 112, 70, 0.3);
            color: white; outline: none; transition: 0.3s; box-sizing: border-box; font-size: 14px;
        }
        input:focus { border-color: var(--accent); background: rgba(255,255,255,0.1); }

        .btn-main {
            width: 100%; padding: 16px; border: none; border-radius: 10px;
            background: linear-gradient(135deg, var(--terracotta) 0%, var(--dark-red) 100%);
            color: white; font-weight: 800; font-size: 16px; cursor: pointer; margin-top: 20px;
        }

        .toggle-link { margin-top: 20px; font-size: 12px; color: var(--accent); cursor: pointer; text-decoration: underline; opacity: 0.8; }

        /* ‰ª∑Ê†ºË°®Ê†∑Âºè */
        .pricing-list { width: 100%; max-width: 480px; display: flex; flex-direction: column; gap: 25px; }
        .price-item {
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px; padding: 30px; position: relative; backdrop-filter: blur(10px); transition: 0.3s; cursor: pointer;
        }
        .price-item:hover { border-color: var(--accent); transform: translateY(-5px); }
        .price-item.active { border-color: var(--accent); border-width: 2px; background: rgba(229, 204, 132, 0.05); }
        .price-item h3 { margin: 0; color: var(--accent); font-size: 22px; }
        
        .price-row { display: flex; align-items: baseline; gap: 10px; margin: 15px 0 5px 0; }
        .price-now { font-size: 34px; font-weight: 900; color: white; }
        .price-old { font-size: 18px; color: #888; text-decoration: line-through; }
        .price-reason { font-size: 12px; color: var(--accent); opacity: 0.8; margin-bottom: 10px; display: block; }
        .price-remark { font-size: 14px; color: var(--primary); font-weight: bold; margin-bottom: 15px; display: block; }

        .features { padding: 0; list-style: none; text-align: left; }
        .features li { font-size: 13px; margin-bottom: 8px; opacity: 0.9; display: flex; align-items: flex-start; gap: 10px; line-height: 1.4; color: #ddd; }
        .features li i { color: var(--primary); margin-top: 3px; font-size: 12px;}

        .coming-soon { position: absolute; top: 20px; right: 20px; font-size: 10px; background: rgba(255,255,255,0.1); padding: 4px 10px; border-radius: 10px; color: #aaa; }

        /* ÊîØ‰ªòÈù¢Êùø */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; align-items: center; justify-content: center; padding: 20px; }
        .modal-content { background: #111; border: 1px solid var(--terracotta); border-radius: 24px; width: 100%; max-width: 480px; padding: 35px; text-align: center; position: relative; }
        .modal-close { position: absolute; top: 20px; right: 20px; font-size: 24px; color: #666; cursor: pointer; }
        .pay-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 25px; }
        .pay-btn { background: #222; border: 1px solid #333; color: white; padding: 15px; border-radius: 12px; cursor: pointer; transition: 0.3s; display: flex; flex-direction: column; align-items: center; gap: 8px; font-size: 13px; }
        .pay-btn:hover { background: #2a2a2a; border-color: var(--accent); }
        .pay-info-box { display: none; margin-top: 25px; padding: 20px; background: #000; border-radius: 12px; border: 1px dashed var(--terracotta); animation: fadeIn 0.4s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        #msg { margin-top: 15px; font-size: 13px; font-weight: bold; text-align: center; }
    </style>
</head>
<body>

    <div class="bg-overlay"></div>

    <div class="top-nav">
        <button class="lang-btn" onclick="toggleLang()" id="langBtn">üá∑üá∫ RU / üá∫üá∏ EN / üá®üá≥ CN</button>
    </div>

    <div class="wrapper">
        <div class="login-card">
            <div class="logo-area">
                <i class="fas fa-film"></i>
                <h1 id="brandName">Ê±âËØ≠ Vlog</h1>
                <p id="modeDesc">Ê≤âÊµ∏ÂºèÂ≠¶Ê±âËØ≠ ¬∑ ÁôªÂΩï‰∏≠ÂøÉ</p>
            </div>

            <div class="input-group">
                <label id="labelUser">Ë¥¶Âè∑ / Email / –õ–æ–≥–∏–Ω</label>
                <input type="email" id="email" placeholder="example@mail.com">
            </div>
            <div class="input-group">
                <label id="labelPass">ÂØÜÁ†Å / Password / –ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>

            <button class="btn-main" onclick="handleAuthAction()" id="actionBtn">ÁôªÂΩï / Login / –í–æ–π—Ç–∏</button>
            <div id="msg"></div>

            <div class="toggle-link" onclick="toggleMode()" id="toggleBtn">
                ËøòÊ≤°ÊúâË¥¶Âè∑ÔºüÁÇπÂáªËøôÈáåÊ≥®ÂÜåÊñ∞Áî®Êà∑
            </div>
        </div>

        <!-- ‰ª∑Ê†ºÂàóË°®ÂÆπÂô® -->
        <div class="pricing-list" id="pricingList"></div>
    </div>

    <!-- ÊîØ‰ªòÈù¢Êùø -->
    <div id="payModal" class="modal">
        <div class="modal-content">
            <div class="modal-close" onclick="closePayModal()">√ó</div>
            <h2 id="payModalTitle" style="color:var(--accent); margin:0;">Ëß£ÈîÅÊ≠£ÂºèÁâà</h2>
            
            <p id="payStep1" style="font-size:13px; opacity:0.9; margin-top:15px; color:var(--accent);"></p>
            <input type="email" id="payEmail" placeholder="" style="margin-top:10px; border: 1px solid var(--terracotta); background: #000; text-align:center;">
            
            <p id="payStep2" style="font-size:13px; opacity:0.7; margin-top:20px;"></p>
            <div class="pay-grid">
                <div class="pay-btn" onclick="showPayDetail('wechat')"><i class="fab fa-weixin" style="color:#07c160"></i>WeChat</div>
                <div class="pay-btn" onclick="showPayDetail('alipay')"><i class="fab fa-alipay" style="color:#1677ff"></i>Alipay</div>
                <div class="pay-btn" onclick="showPayDetail('sbp')"><i class="fas fa-mobile-alt" style="color:var(--primary)"></i>–°–ë–ü (–ë–∞–Ω–∫)</div>
                <div class="pay-btn" onclick="showPayDetail('paypal')"><i class="fab fa-paypal" style="color:#003087"></i>PayPal</div>
            </div>

            <div id="payDetail" class="pay-info-box">
                <div id="payContent" style="font-size:14px; text-align:left;"></div>
                <p id="screenshotTip" style="font-size:11px; color:var(--accent); margin-top:15px; font-weight:bold; line-height:1.4;"></p>
                <a href="https://t.me/zhouyuhe" target="_blank" class="btn-main" style="display:inline-block; width:auto; padding:10px 20px; font-size:13px; background:var(--terracotta); text-decoration:none;">
                    <i class="fab fa-telegram"></i> ËÅîÁ≥ªËÄÅÂ∏àÂºÄÈÄöÊùÉÈôê
                </a>
            </div>
        </div>
    </div>

    <script>
        const loginClient = window.supabase.createClient('https://bwweaohahsafbecogist.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ3d2Vhb2hhaHNhZmJlY29naXN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3NTk3MjMsImV4cCI6MjA4NDMzNTcyM30.ZqViPiwlvzzaqkWLMzejjpgHXeztkD0K0ne32kfGhWw');

        let currentLang = 'ru';
        let isSignUpMode = false;

        const uiDict = {
            ru: {
                brand: "–ö–∏—Ç–∞–π—Å–∫–∏–π Vlog", login_desc: "–£—á–∏—Ç–µ –∫–∏—Ç–∞–π—Å–∫–∏–π —á–µ—Ä–µ–∑ –≤–∏–¥–µ–æ", go_signup: "–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è", go_login: "–ï—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏", btn_login: "–í–æ–π—Ç–∏", btn_signup: "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è",
                pay_modal_title: "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å Season 1", pay_step_1: "–®–∞–≥ 1: –í–≤–µ–¥–∏—Ç–µ –≤–∞—à —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π email", pay_step_2: "–®–∞–≥ 2: –í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã", pay_email_placeholder: "–≤–∞—à@email.com",
                pay_tip: "‚ö†Ô∏è –í–∞–∂–Ω–æ: –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤—å—Ç–µ [—Å–∫—Ä–∏–Ω—à–æ—Ç —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã] –∏ [–∫–≤–∏—Ç–∞–Ω—Ü–∏—é] —É—á–∏—Ç–µ–ª—é –≤ Telegram.",
                plans: [
                    { id: 'trial', title: "–ü—Ä–æ–±–Ω–∞—è –≤–µ—Ä—Å–∏—è", price: "$0", features: ["–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ 3 –≤–∏–¥–µ–æ", "–î–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∞–π—Ç–∞", "–ü–µ—á–∞—Ç—å —Å–∫—Ä–∏–ø—Ç–æ–≤ —Ç–æ–ª—å–∫–æ –¥–ª—è 3 —É—Ä–æ–∫–æ–≤", "–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ —É—á–µ–±–Ω–∏–∫–∏ (PDF) –Ω–µ–ª—å–∑—è —Å–∫–∞—á–∞—Ç—å", "–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: 24 —á–∞—Å–∞"] },
                    { id: 's1', title: "–ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è (–°–µ–∑–æ–Ω 1)", price: "$29.9", old: "$49.9", reason: "(–¶–µ–Ω–∞ —Å–Ω–∏–∂–µ–Ω–∞, –≤–∏–¥–µ–æ –µ—â–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è)", remark: "2300P / 208¬•", active: true, features: ["120 –∫–æ—Ä–æ—Ç–∫–∏—Ö –≤–∏–¥–µ–æ—É—Ä–æ–∫–æ–≤", "–ë–û–ù–£–°: 30 –≤–∏–¥–µ–æ —Ç–æ–∫-—à–æ—É", "–ü–µ—á–∞—Ç—å –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –∫ –≤–∏–¥–µ–æ", "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö PDF", "–û–±–ª–∞—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö", "–†–ê–ó–û–í–ê–Ø –û–ü–õ–ê–¢–ê ‚Äî –í–ï–ß–ù–´–ô –î–û–°–¢–£–ü"] },
                    { id: 's2', title: "–°–µ–∑–æ–Ω 2", price: "-", soon: "–û–ñ–ò–î–ê–ï–¢–°–Ø", features: ["–°–∫–æ—Ä–æ –≤ –ø—Ä–æ–¥–∞–∂–µ..."] },
                    { id: 'vip', title: "–°—É–ø–µ—Ä VIP", price: "$80", soon: "–û–ñ–ò–î–ê–ï–¢–°–Ø", features: ["–í—Å–µ –≤–∏–¥–µ–æ: Vlog, –ü–æ–¥–∫–∞—Å—Ç—ã, HSK", "–°–µ—Ä–∏–∞–ª—ã, –§–∏–ª—å–º—ã, –ù–æ–≤–æ—Å—Ç–∏, –®–æ—É"] }
                ]
            },
            cn: {
                brand: "Ê±âËØ≠ Vlog ËØæÂ†Ç", login_desc: "Ê≤âÊµ∏ÂºèÂ≠¶Ê±âËØ≠ ¬∑ ÁôªÂΩï‰∏≠ÂøÉ", go_signup: "ËøòÊ≤°ÊúâË¥¶Âè∑ÔºüÁÇπÂáªËøôÈáåÊ≥®ÂÜåÊñ∞Áî®Êà∑", go_login: "Â∑≤ÊúâË¥¶Âè∑ÔºüËøîÂõûÁôªÂΩï", btn_login: "ÁôªÂΩï / Login / –í–æ–π—Ç–∏", btn_signup: "Ê≥®ÂÜå / Sign Up / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è",
                pay_modal_title: "Ëß£ÈîÅÊ≠£ÂºèÁâà (Á¨¨‰∏ÄÂ≠£)", pay_step_1: "Á¨¨‰∏ÄÊ≠•ÔºöËæìÂÖ•ÊÇ®Ê≥®ÂÜåË¥¶Âè∑Êó∂‰ΩøÁî®ÁöÑÈÇÆÁÆ±", pay_step_2: "Á¨¨‰∫åÊ≠•ÔºöÈÄâÊã©ÊîØ‰ªòÊñπÂºè", pay_email_placeholder: "ËæìÂÖ•ÊÇ®ÁöÑÊ≥®ÂÜåÈÇÆÁÆ±",
                pay_tip: "‚ö†Ô∏è ÈáçË¶ÅÔºöÊîØ‰ªòÂêéËØ∑Â∞Ü„ÄêÊ≠§È°µÈù¢Êà™Âõæ„ÄëÂíå„Äê‰ªòÊ¨æË¥¶Âçï„Äë‰∏ÄËµ∑ÂèëÁªôËÄÅÂ∏àÊ†∏ÂØπ„ÄÇ",
                plans: [
                    { id: 'trial', title: "ËØïÁî®Áâà", price: "$0", features: ["Ê≥®ÂÜåÂèØËßÇÁúã 3 ‰∏™ËßÜÈ¢ë", "‰ΩìÈ™åÁΩëÁ´ôÂÜÖÊâÄÊúâÂäüËÉΩ", "‰ªÖÂèØÊâìÂç∞ 3 ‰∏™Âè∞ËØçÊú¨", "ÁîµÂ≠êËØæÊú¨ (PDF) ‰∏çÂèØ‰∏ãËΩΩ", "ÊúâÊïàÊúü 24 Â∞èÊó∂"] },
                    { id: 's1', title: "Ê≠£ÂºèÁâà (Á¨¨‰∏ÄÂ≠£)", price: "$29.9", old: "$49.9", reason: "(Áî±‰∫éËßÜÈ¢ëÊöÇÊú™Êõ¥Êñ∞ÂÆå)", remark: "208¬• / 2300P", active: true, features: ["120 ‰∏™Á≤æÂΩ©Áü≠ËßÜÈ¢ë", "ÈôêÊó∂Ëµ†ÈÄÅ 30 ‰∏™ËÑ±Âè£ÁßÄËßÜÈ¢ë", "ÊâÄÊúâÂè∞ËØçÂâßÊú¨ÂèØÊâìÂç∞", "ÊâÄÊúâ PDF ËµÑÊ∫êÂÖçË¥π‰∏ãËΩΩ", "ÁîüËØçÊú¨Â≠¶‰π†Êï∞ÊçÆ‰∫ëÁ´ØÂêåÊ≠•", "‰π∞Êñ≠Âà∂Ôºå‰∏ÄÊ¨°ÊÄß‰ªòÊ¨æÊ∞∏‰πÖËßÇÁúã"] },
                    { id: 's2', title: "Á¨¨‰∫åÂ≠£", price: "-", soon: "Êï¨ËØ∑ÊúüÂæÖ", features: ["Âç≥Â∞Ü‰∏äÁ∫ø"] },
                    { id: 'vip', title: "Ë∂ÖÁ∫ß‰ºöÂëò", price: "$80", soon: "Êï¨ËØ∑ÊúüÂæÖ", features: ["ÂÖ®Á´ôËßÜÈ¢ë: Vlog, ÂçöÂÆ¢, HSK", "ÂÖ®Á´ôÁîµËßÜÂâß„ÄÅÁîµÂΩ±„ÄÅÊñ∞Èóª„ÄÅÁªºËâ∫"] }
                ]
            },
            en: {
                brand: "Hanyu Vlog Class", login_desc: "Immersive Chinese Learning", go_signup: "New? Create Account", go_login: "Have account? Login", btn_login: "Login", btn_signup: "Sign Up",
                pay_modal_title: "Unlock Season 1 Full Access", pay_step_1: "Step 1: Enter your registered email", pay_step_2: "Step 2: Select payment method", pay_email_placeholder: "your@email.com",
                pay_tip: "‚ö†Ô∏è Important: After payment, send [screenshot of this page] and [receipt] to the teacher.",
                plans: [
                    { id: 'trial', title: "Trial Version", price: "$0", features: ["Watch 3 videos upon registration", "Full access to all interactive tools", "Print only 3 scripts", "PDF downloads locked", "Validity: 24 hours"] },
                    { id: 's1', title: "Official (Season 1)", price: "$29.9", old: "$49.9", reason: "(Discounted: still updating)", remark: "approx. 208¬• / 2300P", active: true, features: ["120 short video lessons", "Bonus: 30 Talk Show videos", "Unlimited script printing", "All PDF textbooks free to download", "Cloud vocab sync", "ONE-TIME PAYMENT, LIFETIME ACCESS"] },
                    { id: 's2', title: "Season 2", price: "-", soon: "COMING SOON", features: ["Stay tuned"] },
                    { id: 'vip', title: "Super Member", price: "$80", soon: "COMING SOON", features: ["All site videos: Vlog, Blogs, HSK", "All TV Dramas, Movies, News & Shows"] }
                ]
            }
        };

        function updateUI() {
            const dict = uiDict[currentLang];
            document.getElementById('brandName').innerText = dict.brand;
            document.getElementById('actionBtn').innerText = isSignUpMode ? dict.btn_signup : dict.btn_login;
            document.getElementById('toggleBtn').innerText = isSignUpMode ? dict.go_login : dict.go_signup;
            document.getElementById('modeDesc').innerText = dict.login_desc;
            
            // Êõ¥Êñ∞ÂºπÁ™óÊñáÂ≠ó
            document.getElementById('payModalTitle').innerText = dict.pay_modal_title;
            document.getElementById('payStep1').innerHTML = dict.pay_step_1;
            document.getElementById('payStep2').innerText = dict.pay_step_2;
            document.getElementById('payEmail').placeholder = dict.pay_email_placeholder;

            // Ê†∏ÂøÉÔºöÊ∏≤Êüì‰ª∑Ê†ºÂàóË°®
            const list = document.getElementById('pricingList');
            list.innerHTML = dict.plans.map(p => `
                <div class="price-item ${p.active ? 'active' : ''}" onclick="handlePriceClick('${p.id}')">
                    ${p.soon ? `<span class="coming-soon">${p.soon}</span>` : ''}
                    <h3>${p.title}</h3>
                    <div class="price-row">
                        <span class="price-now">${p.price}</span>
                        ${p.old ? `<span class="price-old">${p.old}</span>` : ''}
                    </div>
                    ${p.reason ? `<div class="price-reason">${p.reason}</div>` : ''}
                    ${p.remark ? `<span class="price-remark">${p.remark}</span>` : ''}
                    <ul class="features">${p.features.map(f => `<li><i class="fas fa-check-circle"></i> ${f}</li>`).join('')}</ul>
                </div>`).join('');
        }

        function handlePriceClick(id) {
            if (id === 'trial') { isSignUpMode = true; updateUI(); window.scrollTo({ top: 0, behavior: 'smooth' }); document.getElementById('email').focus(); }
            else if (id === 's1') { document.getElementById('payModal').style.display = 'flex'; document.getElementById('payEmail').value = document.getElementById('email').value; }
        }

        function closePayModal() { document.getElementById('payModal').style.display = 'none'; }

        function showPayDetail(type) {
            const userEmail = document.getElementById('payEmail').value.trim();
            if (!userEmail || !userEmail.includes('@')) { alert(currentLang === 'ru' ? "–í–≤–µ–¥–∏—Ç–µ Email" : "ËØ∑ÂÖàËæìÂÖ•Ê≠£Á°ÆÈÇÆÁÆ±"); return; }
            document.getElementById('payDetail').style.display = 'block';
            document.getElementById('screenshotTip').innerText = uiDict[currentLang].pay_tip;
            const content = document.getElementById('payContent');
            const pInfo = "<b>208 ¬• / 2300 —Ä—É–±.</b>";
            if (type === 'wechat') content.innerHTML = `<img src="wechat_pay.jpg" style="width:180px; margin-bottom:10px;"><p>WeChat Pay: ${pInfo}</p>`;
            else if (type === 'alipay') content.innerHTML = `<img src="alipay_pay.jpg" style="width:180px; margin-bottom:10px;"><p>Alipay: ${pInfo}</p>`;
            else if (type === 'sbp') content.innerHTML = `<div style="background:#1a1a1a; padding:15px; border-radius:10px;"><p><b>–°–ë–ü (–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –Ω–æ–º–µ—Ä—É):</b></p><p style="font-size:18px; color:var(--primary);">+7 962 726 66 18</p><p>–ü–æ–ª—É—á–∞—Ç–µ–ª—å: <b>–ß–∂–æ—É –Æ–π—Ö—ç</b></p><p>–°—É–º–º–∞: 2300 —Ä—É–±.</p></div>`;
            else if (type === 'paypal') content.innerHTML = `<p>PayPal: <b>zhouyuhe525@gmail.com</b></p><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=zhouyuhe525@gmail.com&item_name=Season1&amount=29.90&currency_code=USD" target="_blank" class="btn-main" style="display:inline-block; width:auto; padding:10px 20px;">Pay via PayPal ($29.9)</a>`;
        }

        function toggleLang() { currentLang = (currentLang === 'ru') ? 'en' : (currentLang === 'en' ? 'cn' : 'ru'); updateUI(); }
        function toggleMode() { isSignUpMode = !isSignUpMode; updateUI(); }

        async function handleAuthAction() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const msg = document.getElementById('msg');
            if(!email || !password) { msg.style.color="red"; msg.innerText = "Error: Input required"; return; }
            try {
                if (isSignUpMode) {
                    const { error } = await loginClient.auth.signUp({ email, password });
                    if (error) throw error;
                    msg.style.color = "#E5CC84"; msg.innerText = "Success! Log in now.";
                    setTimeout(() => { toggleMode(); }, 1500);
                } else {
                    const { data, error } = await loginClient.auth.signInWithPassword({ email, password });
                    if (error) throw error;
                    const newToken = Date.now() + "_" + Math.random();
                    await loginClient.from('profiles').upsert({ id: data.user.id, session_token: newToken });
                    localStorage.setItem('my_session_token', newToken);
                    const { data: profile } = await loginClient.from('profiles').select('progress, access_tags').eq('id', data.user.id).maybeSingle();
                    if (profile) {
                        if(profile.progress) Object.keys(profile.progress).forEach(k => localStorage.setItem(k, profile.progress[k]));
                        if(profile.access_tags) localStorage.setItem('my_access_tags', JSON.stringify(profile.access_tags));
                    }
                    window.location.href = 'home.html?from_login=1';
                }
            } catch (err) { msg.style.color = "#ff4d4f"; msg.innerText = err.message; }
        }
        document.addEventListener('DOMContentLoaded', () => { updateUI(); document.body.classList.add('loaded'); });
    </script>
</body>
</html>
